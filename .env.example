# ============================================================================
# Enhanced Document Converter v2.1 - Configuration
# ============================================================================
# Copy this file to .env and configure your settings
# DO NOT commit .env to version control!

# ============================================================================
# REQUIRED: API Keys
# ============================================================================

# Mistral AI API Key (REQUIRED for OCR features)
# Get your API key from: https://console.mistral.ai/api-keys/
MISTRAL_API_KEY="your_mistral_api_key_here"

# ============================================================================
# Optional API Keys
# ============================================================================

# OpenAI API Key (optional, for MarkItDown LLM features)
OPENAI_API_KEY=""

# Azure Document Intelligence (optional, for advanced document processing)
AZURE_DOC_INTEL_ENDPOINT=""
AZURE_DOC_INTEL_KEY=""

# ============================================================================
# Mistral OCR Configuration
# ============================================================================

# OCR Model (default: mistral-ocr-latest)
MISTRAL_OCR_MODEL="mistral-ocr-latest"

# Include images in OCR output (default: true)
MISTRAL_INCLUDE_IMAGES="true"

# Save OCR metadata as JSON (default: true, needed for quality assessment)
SAVE_MISTRAL_JSON="true"

# ============================================================================
# OCR Quality Assessment Configuration
# ============================================================================

# Quality score thresholds (0-100 scale)
OCR_QUALITY_THRESHOLD_EXCELLENT="80"
OCR_QUALITY_THRESHOLD_GOOD="60"
OCR_QUALITY_THRESHOLD_ACCEPTABLE="40"

# Quality detection thresholds (fine-tune weak page detection)
OCR_MIN_TEXT_LENGTH="50"
OCR_MIN_DIGIT_COUNT="20"
OCR_MIN_UNIQUENESS_RATIO="0.3"
OCR_MAX_PHRASE_REPETITIONS="5"
OCR_MIN_AVG_LINE_LENGTH="10"

# ============================================================================
# Mistral File Upload Management
# ============================================================================

# Automatically clean up old uploaded files (default: true)
CLEANUP_OLD_UPLOADS="true"

# Delete uploaded files older than N days (default: 7)
UPLOAD_RETENTION_DAYS="7"

# ============================================================================
# Structured Data Extraction (Advanced)
# ============================================================================

# Enable structured output extraction (default: true)
MISTRAL_ENABLE_STRUCTURED_OUTPUT="true"

# Document schema type (default: auto)
# Options: invoice, financial_statement, form, generic, auto
MISTRAL_DOCUMENT_SCHEMA_TYPE="auto"

# Enable bounding box annotation (default: false)
MISTRAL_ENABLE_BBOX_ANNOTATION="false"

# Enable document-level annotation (default: false)
MISTRAL_ENABLE_DOCUMENT_ANNOTATION="false"

# ============================================================================
# Image Optimization
# ============================================================================

# Enable image optimization before OCR (default: true)
MISTRAL_ENABLE_IMAGE_OPTIMIZATION="true"

# Enable image preprocessing (default: false)
MISTRAL_ENABLE_IMAGE_PREPROCESSING="false"

# Maximum image dimension for optimization (default: 2048)
MISTRAL_MAX_IMAGE_DIMENSION="2048"

# Image quality threshold for JPEG (default: 70)
MISTRAL_IMAGE_QUALITY_THRESHOLD="70"

# ============================================================================
# MarkItDown Configuration
# ============================================================================

# Enable MarkItDown LLM features (default: false)
MARKITDOWN_USE_LLM="false"

# OpenAI model for MarkItDown LLM features
MARKITDOWN_LLM_MODEL="gpt-4-vision-preview"

# Enable MarkItDown plugins (default: false)
MARKITDOWN_ENABLE_PLUGINS="false"

# Maximum file size for processing (MB) (default: 100)
MARKITDOWN_MAX_FILE_SIZE_MB="100"

# ============================================================================
# Table Extraction Configuration
# ============================================================================

# Minimum Camelot accuracy to accept table (%) (default: 75.0)
CAMELOT_MIN_ACCURACY="75.0"

# Maximum whitespace percentage (%) (default: 30.0)
CAMELOT_MAX_WHITESPACE="30.0"

# ============================================================================
# PDF to Image Conversion
# ============================================================================

# Output image format (default: png)
# Options: png, jpeg, ppm, tiff
PDF_IMAGE_FORMAT="png"

# Image resolution/DPI (default: 200)
PDF_IMAGE_DPI="200"

# Concurrent conversion threads (default: 4)
PDF_IMAGE_THREAD_COUNT="4"

# Use pdftocairo for better quality (default: true)
PDF_IMAGE_USE_PDFTOCAIRO="true"

# ============================================================================
# System Configuration
# ============================================================================

# Poppler path (Windows only)
POPPLER_PATH=""

# Ghostscript path (Windows only, for Camelot)
GHOSTSCRIPT_PATH=""

# Cache duration in hours (default: 24)
CACHE_DURATION_HOURS="24"

# Automatically clear expired cache (default: true)
AUTO_CLEAR_CACHE="true"

# ============================================================================
# Logging
# ============================================================================

# Log level (default: INFO)
LOG_LEVEL="INFO"

# Save processing logs to files (default: true)
SAVE_PROCESSING_LOGS="true"

# Show verbose progress (default: true)
VERBOSE_PROGRESS="true"

# ============================================================================
# Performance
# ============================================================================

# Maximum concurrent files in batch (default: 5)
MAX_CONCURRENT_FILES="5"

# Enable async operations (default: true)
ENABLE_ASYNC_OPERATIONS="true"

# Enable streaming (default: false)
ENABLE_STREAMING="false"

# ============================================================================
# Retry Configuration
# ============================================================================

# Maximum retry attempts (default: 3)
MAX_RETRIES="3"

# Initial retry interval (ms) (default: 1000)
RETRY_INITIAL_INTERVAL_MS="1000"

# Maximum retry interval (ms) (default: 10000)
RETRY_MAX_INTERVAL_MS="10000"

# Exponential backoff multiplier (default: 2.0)
RETRY_EXPONENT="2.0"

# Maximum total retry time (ms) (default: 60000)
RETRY_MAX_ELAPSED_TIME_MS="60000"

# Retry on connection errors (default: true)
RETRY_CONNECTION_ERRORS="true"

# ============================================================================
# Output Configuration
# ============================================================================

# Generate plain text output (default: true)
GENERATE_TXT_OUTPUT="true"

# Include metadata in YAML frontmatter (default: true)
INCLUDE_METADATA="true"

# Table output formats (default: markdown,csv)
TABLE_OUTPUT_FORMATS="markdown,csv"

# Enable batch metadata tracking (default: true)
ENABLE_BATCH_METADATA="true"
