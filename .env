# --------------------------------------------------------------------------
#               Enhanced Document Converter Configuration
# --------------------------------------------------------------------------
#
# Copy this file to .env and fill in the values for the services you want to use.
#
# === MISTRAL OCR CONFIGURATION (Required for OCR features) ===
# Your Mistral AI API key. Get one from the Mistral platform.
MISTRAL_API_KEY="your_mistral_api_key_here"
# The OCR model to use for document processing.
# Updated for August 2025 - supports latest models
MISTRAL_OCR_MODEL=mistral-ocr-latest
# Alternative models for different use cases:
# - "mistral-ocr-latest" (default): Latest OCR model (currently mistral-ocr-2505)
# - "mistral-medium-latest": Multimodal model for documents with images/text (mistral-medium-2508)
# - "pixtral-large-latest": Advanced multimodal model for complex image understanding (pixtral-large-2411)
# - "codestral-latest": Advanced coding model for processing code-heavy documents (codestral-2508)
# - "magistral-medium-latest": Frontier-class reasoning model (magistral-medium-2507)
# - "ministral-8b-latest": Efficient edge model (ministral-8b-2410)
# - "ministral-3b-latest": World's best edge model (ministral-3b-2410)
# If True, includes base64-encoded images in the OCR response. (true/false)
MISTRAL_INCLUDE_IMAGES=true
# NEW: Whether Mistral should generate descriptions (annotations) for extracted images. (true/false)
MISTRAL_INCLUDE_IMAGE_ANNOTATIONS=true
# Save the raw JSON response from Mistral for debugging purposes. (true/false)
# Files will be saved in the 'logs/' directory.
SAVE_MISTRAL_JSON=false
# Timeout for HTTP requests to the Mistral API, in seconds.
MISTRAL_HTTP_TIMEOUT=300
# NEW: Enable automatic model selection based on document characteristics (true/false)
# IMPORTANT: Set to true to allow intelligent model selection based on file type and content
MISTRAL_AUTO_MODEL_SELECTION=true
# NEW: Preferred models for different document types (comma-separated list)
# Order matters - first suitable model will be used
# PRIORITY FIX: mistral-ocr-latest should be FIRST for optimal PDF/table extraction
MISTRAL_PREFERRED_MODELS=mistral-ocr-latest,pixtral-large-latest,mistral-medium-latest,codestral-latest

# === MARKITDOWN LLM & AZURE CONFIGURATION (Optional) ===
# Use an LLM (like GPT-4o) to generate descriptions for images found in documents.
# Requires an OpenAI-compatible API key.
MARKITDOWN_USE_LLM=false
MARKITDOWN_LLM_MODEL=gpt-4o-mini
OPENAI_API_KEY="your_openai_api_key_here"
# Use Azure Document Intelligence for enhanced PDF processing through Markitdown.
# Requires an Azure account and a Document Intelligence resource.
AZURE_DOC_INTEL_ENDPOINT=""
AZURE_DOC_INTEL_KEY=""

# === MARKITDOWN ADVANCED SETTINGS (Optional) ===
#
# Control specific behaviors of the Markitdown engine.
#
# Table strategy: 'ocr_only', 'text_only', 'auto' (default)
MARKITDOWN_TABLE_STRATEGY=auto
# Image extraction strategy: 'extract', 'ignore', 'auto' (default)
MARKITDOWN_IMAGE_STRATEGY=auto
# PDF processing mode (if Azure Doc Intel is not used): 'auto' (default), 'text', 'ocr'
MARKITDOWN_PDF_MODE=auto
# Enable Markitdown's third-party plugin system.
# See Markitdown documentation for how to install and use plugins.
MARKITDOWN_ENABLE_PLUGINS=true

# === ENHANCED MARKITDOWN FEATURES ===
# Enable experimental features in Markitdown (true/false)
MARKITDOWN_EXPERIMENTAL=false
# Use custom processing options for different file types (true/false)
MARKITDOWN_CUSTOM_OPTIONS=true
# Enable Markitdown's built-in caching for repeated files (true/false)
MARKITDOWN_USE_CACHE=true
# Maximum file size for Markitdown processing in MB
MARKITDOWN_MAX_FILE_SIZE_MB=100
# Enable advanced table detection algorithms (true/false)
MARKITDOWN_ADVANCED_TABLES=true
# Enable enhanced image processing and OCR (true/false)
MARKITDOWN_ENHANCED_IMAGES=true
# Image quality for extracted images (1-100, higher = better quality)
MARKITDOWN_IMAGE_QUALITY=90
# Enable parallel processing for large documents (true/false)
MARKITDOWN_PARALLEL_PROCESSING=true
# Number of parallel workers for document processing
MARKITDOWN_WORKERS=4

# === PERFORMANCE & PROCESSING SETTINGS ===
# The number of files to process in a single batch in batch mode.
BATCH_SIZE=5
# The maximum number of times to retry a failed network request.
MAX_RETRIES=3
# The delay in seconds between retries (used as base for exponential backoff).
RETRY_DELAY=5
# The file size in MB above which files are uploaded to Mistral instead of
# being sent in a base64-encoded request.
LARGE_FILE_THRESHOLD_MB=45
# NEW: Duration in hours to keep cached results (used by IntelligentCache).
CACHE_DURATION_HOURS=24
# Whether to extract tables from PDFs in batch/enhanced modes (uses pdfplumber/Camelot).
BATCH_EXTRACT_TABLES=false

# === SYSTEM PATHS (Optional) ===
# Required for the "PDF to Images" feature.
# Provide the absolute path to the 'bin' directory of your Poppler installation.
# On Linux/macOS, this is often not needed if Poppler is installed via a package manager.
# Windows example: POPPLER_PATH="C:\path\to\poppler-23.08.0\bin"
POPPLER_PATH=""

# === ADVANCED MISTRAL AI FEATURES ===
# Enable function calling for structured data extraction (true/false)
MISTRAL_ENABLE_FUNCTIONS=false
# Enable structured outputs with JSON schema (true/false)
MISTRAL_ENABLE_STRUCTURED_OUTPUT=false
# Schema type for structured output ('auto', 'financial_statement', 'document_analysis', 'image_description')
MISTRAL_STRUCTURED_SCHEMA_TYPE=auto
# Enable multi-turn conversations for complex analysis (true/false)
MISTRAL_ENABLE_MULTI_TURN=false
# Maximum number of conversation turns
MISTRAL_MAX_TURNS=3

# === ENHANCED IMAGE PROCESSING ===
# Enable advanced image quality analysis and optimization (true/false)
MISTRAL_ENABLE_IMAGE_OPTIMIZATION=true
# Enable image preprocessing to improve OCR accuracy (true/false)
MISTRAL_ENABLE_IMAGE_PREPROCESSING=true
# Maximum image dimension for processing (longest side in pixels)
MISTRAL_MAX_IMAGE_DIMENSION=2048
# Image quality threshold for using advanced models (0-100)
MISTRAL_IMAGE_QUALITY_THRESHOLD=70